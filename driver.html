<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CRM –í–æ–¥–∏—Ç–µ–ª—è - –í–æ–¥–æ–≤–æ–∑–∫–∞ –∏ –°–µ–ø—Ç–∏–∫</title>
    <link rel="stylesheet" href="driver-styles.css">
    <script src="https://api-maps.yandex.ru/2.1/?apikey=63c21778-deb0-4a95-bc2a-fb4d2dd46449&lang=ru_RU" type="text/javascript"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöõ CRM –í–æ–¥–∏—Ç–µ–ª—è</h1>
            <div class="driver-info">
                <span id="driverName">–í–æ–¥–∏—Ç–µ–ª—å</span>
                <button id="logoutBtn">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <div class="stats-panel">
            <div class="stat-card">
                <h3>–ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</h3>
                <span id="newOrdersCount">0</span>
            </div>
            <div class="stat-card">
                <h3>–í —Ä–∞–±–æ—Ç–µ</h3>
                <span id="activeOrdersCount">0</span>
            </div>
            <div class="stat-card">
                <h3>–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</h3>
                <span id="totalCompletedCount">0</span>
            </div>
            <div class="stat-card">
                <h3>–û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫</h3>
                <span id="totalEarnings">0 ‚ÇΩ</span>
            </div>
            <div class="stat-card">
                <h3>–û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è</h3>
                <span id="totalCommission">0 ‚ÇΩ</span>
            </div>
            <div class="stat-card">
                <h3>–°–µ–≥–æ–¥–Ω—è</h3>
                <span id="todayEarnings">0 ‚ÇΩ</span>
            </div>
        </div>

        <div class="main-content">
            <div class="calendar-section">
                <div class="section-header">
                    <h2>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–∫–∞–∑–æ–≤</h2>
                    <div class="calendar-nav">
                        <button id="prevMonth">‚Äπ</button>
                        <span id="currentMonth"></span>
                        <button id="nextMonth">‚Ä∫</button>
                    </div>
                </div>
                <div id="calendar" class="calendar"></div>
            </div>

            <div class="orders-section">
                <div class="section-header">
                    <h2>–õ–µ–Ω—Ç–∞ –∑–∞–∫–∞–∑–æ–≤</h2>
                    <button id="refreshBtn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                <button id="testNotificationBtn">üîî –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
                </div>
            
            <div class="filters">
                <button class="filter-btn active" data-status="all">–í—Å–µ</button>
                <button class="filter-btn" data-status="pending">–ù–æ–≤—ã–µ</button>
                <button class="filter-btn" data-status="confirmed">–ü—Ä–∏–Ω—è—Ç—ã–µ</button>
                <button class="filter-btn" data-status="in_progress">–í —Ä–∞–±–æ—Ç–µ</button>
                <button class="filter-btn" data-status="completed">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</button>
            </div>

            <div id="ordersList" class="orders-list">
                <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞ -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="orderDetails"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫–∞–∑–æ–≤ –¥–Ω—è -->
    <div id="dayOrdersModal" class="modal">
        <div class="modal-content day-modal">
            <span class="close-day">&times;</span>
            <div id="dayOrdersContent"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞—Ä—Ç—ã -->
    <div id="mapModal" class="modal">
        <div class="modal-content map-modal">
            <div class="map-header">
                <h3 id="mapTitle">üìç –ú–∞—Ä—à—Ä—É—Ç –∫ –∑–∞–∫–∞–∑—É</h3>
                <span class="close-map">&times;</span>
            </div>
            <div id="orderMap" style="width: 100%; height: 400px;"></div>
            <div class="map-controls">
                <button id="buildRouteBtn" class="btn btn-navigate">üìç –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
                <button id="myLocationBtn" class="btn btn-map">üìç –ú–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</button>
            </div>
        </div>
    </div>

    <script src="driver-script.js"></script>
</body>
</html>